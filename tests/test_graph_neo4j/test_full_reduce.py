import random
import pyzx as zx
from pyzx.utils import VertexType

from tests.test_graph_neo4j._base_unittest import Neo4jUnitTestCase

class TestVindexE2E(Neo4jUnitTestCase):
    def test_vindex_after_creation(self):
        choices = [VertexType.Z, VertexType.X]
        g = self.g
        g.add_vertex(VertexType.BOUNDARY, 0, 0)
        g.add_vertex(VertexType.BOUNDARY, 0, 0)
        for x in range(177):
            g.add_vertex(random.choice(choices), 0, 0)
        g.add_edges([(87, 100),
                    (9, 101),
                    (22, 65),
                    (98, 102),
                    (91, 105),
                    (83, 106),
                    (4, 31),
                    (79, 109),
                    (15, 84),
                    (57, 113),
                    (36, 41),
                    (112, 119),
                    (115, 120),
                    (81, 120),
                    (102, 121),
                    (118, 130),
                    (121, 132),
                    (53, 138),
                    (5, 139),
                    (88, 142),
                    (3, 143),
                    (18, 79),
                    (37, 156),
                    (144, 158),
                    (7, 29),
                    (54, 166),
                    (84, 88),
                    (34, 77),
                    (60, 61),
                    (60, 82),
                    (45, 95),
                    (13, 60),
                    (11, 60),
                    (51, 69),
                    (16, 97),
                    (24, 32),
                    (20, 32),
                    (31, 62),
                    (77, 93),
                    (40, 83),
                    (32, 39),
                    (0, 2),
                    (54, 94),
                    (2, 3),
                    (11, 57),
                    (45, 57),
                    (27, 35),
                    (1, 4),
                    (3, 4),
                    (4, 28),
                    (21, 46),
                    (30, 42),
                    (5, 6),
                    (7, 9),
                    (2, 10),
                    (41, 43),
                    (26, 43),
                    (6, 73),
                    (18, 56),
                    (33, 56),
                    (3, 14),
                    (9, 16),
                    (71, 80),
                    (15, 80),
                    (14, 17),
                    (4, 67),
                    (15, 67),
                    (33, 51),
                    (10, 51),
                    (42, 51),
                    (9, 18),
                    (17, 34),
                    (2, 34),
                    (42, 68),
                    (18, 23),
                    (11, 23),
                    (12, 33),
                    (5, 70),
                    (19, 52),
                    (38, 52),
                    (12, 52),
                    (9, 26),
                    (30, 58),
                    (57, 63),
                    (51, 53)])
        zx.full_reduce(g)

        self.assertEqual(g.num_vertices(), 4)
